# .pre-commit-config.yaml
# Recommended starter config for a bash-focused repo with GitHub Actions
# Tip: Run `pre-commit autoupdate` regularly to keep revisions current

repos:
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v6.0.0  # latest as of mid-2025 → autoupdate may bump to v6.x or v7.x
    hooks:
      - id: check-yaml
        args: [--allow-multiple-documents]  # needed for many GitHub workflow files
      - id: end-of-file-fixer
      - id: trailing-whitespace
      - id: check-added-large-files
        args: ['--maxkb=500']
      - id: check-merge-conflict
      - id: mixed-line-ending  # often forgotten — enforces LF on non-Windows
        args: [--fix=lf]

  - repo: local
    hooks:
      - id: validate-devcontainer-json
        name: Validate devcontainer.json (JSONC tolerant)
        entry: bash -c 'command -v jq >/dev/null || { echo "jq not found"; exit 1; }; jq . "$1" >/dev/null || { echo "Invalid JSON in $1"; exit 1; }' --
        language: system
        files: ^\.devcontainer/devcontainer\.json$
        # Note: jq ignores // comments → good enough for most devcontainer.json files
        # If you need stricter validation, consider a dedicated JSONC parser

  - repo: https://github.com/koalaman/shellcheck-precommit
    rev: v0.11.0  # still current in 2026; check repo if newer tags appear
    hooks:
      - id: shellcheck
        args: [--severity=warning, --format=gcc]  # gcc format = better pre-commit output
        files: ^(scripts/|\.github/actions/.*\.sh|\.devcontainer/.*\.sh)$

  - repo: https://github.com/Yelp/detect-secrets
    rev: v1.5.0  # latest release (May 2024); no major updates since
    hooks:
      - id: detect-secrets
        args: ['--baseline', '.secrets.baseline']
        # Create baseline once: detect-secrets scan --update .secrets.baseline
        exclude: ^\.devcontainer/.*log$|^.*\.log$|^tmp/|^\\.git/

  - repo: https://github.com/rhysd/actionlint
    rev: v1.7.10  # latest as of late 2025
    hooks:
      - id: actionlint
        # Optional: add -shellcheck= if you want to disable shellcheck integration
        # files: ^\.github/workflows/.*\.ya?ml$   # uncomment if you want to limit scope

  - repo: https://github.com/igorshubovych/markdownlint-cli
    rev: v0.47.0  # latest as of Dec 2025
    hooks:
      - id: markdownlint
        args: ['--config', '.markdownlint.json']
        # files: \\.md$   # usually not needed — defaults to *.md, *.markdown
